---
title: "Sex Specific Contributions Exploratory Analysis"
output: 
  html_document: 
    keep_md: true
date: "2024-02-29"
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

```{r}
library(tidyverse)
library(naniar)
library(janitor)
```

```{r}
dataset <- read_delim("data/Sex_specific_contribution.csv", delim=";") %>% clean_names()
```
First, we look at our dataset and look for null or NA values. 
```{r}
glimpse(dataset)
```
```{r}
summary(dataset)
```
```{r}
miss_var_summary(dataset)
```

There appear to be NAs, but are all accurately represented as NAs. 

1. We want to understand the distribution of sexes. 

```{r}
sex_distribution <- dataset %>% 
  ggplot(aes(x=nest_builder, fill=nest_builder)) + 
  geom_bar() + 
  theme(legend.position = "none",
        axis.text.x = element_text(angle=50, hjust=1)) +
  labs(title="Distribution of Nest Builder Sex",
       x="Nest Builder", 
       y="Count",
       fill="Nest_builder")

sex_distribution + scale_fill_brewer(palette="BrBG")
```
We see that the most common nest builder is female, followed by both parents, then neither, and the least common (which is very uncommon) is a male nest builder.

Who are the male nest builders?
```{r}
dataset %>% 
  select(species, nest_builder) %>% 
  filter(nest_builder == "male")
```

2. Do other factors have correlations with the sex of the nest builder?

Let's look at how nest site and nest builder correlate.

```{r}
builder_vs_site <- dataset %>% 
  ggplot(aes(x=nest_builder, fill=nest_builder)) + 
  geom_bar() +
  theme(axis.text.x = element_text(angle=50, hjust=1)) +
  labs(title="Nest Builder Sex by Site",
       x="Nest Builder", 
       y="Count",
       fill="Nest_builder") + 
  facet_wrap(~nest_site)

builder_vs_site + scale_fill_brewer(palette="BrBG")
```
We see that females tend to take the lead in ground and grass reed nest building. Both parents tend to be more involved in ground holes, ledges, tree bushes, walls, and water, while neither may do work in tree holes. 

Here's another way of visualizing the same info:
```{r}
dataset %>% 
  ggplot(aes(x=nest_site, fill=nest_builder)) +
  geom_bar(position = "dodge") +
  theme(axis.text.x = element_text(angle=50, hjust=1)) +
  labs(title="Nest Site by Sex of Builder",
       x="Site", 
       y="Count",
       fill="Nest Builder") +
  scale_fill_brewer(palette="BrBG")
```

We'll also take a look at how nest structure and nest builder correlate.
```{r}
builder_vs_type <- dataset %>% 
  filter(nest_builder != "neither") %>% 
  ggplot(aes(x=nest_builder, fill=nest_builder)) + 
  geom_bar(color="black") +
  theme(axis.text.x = element_text(angle=50, hjust=1)) +
  labs(title="Nest Builder Sex by Nest Structure",
       x=NULL, 
       y="Count",
       fill="Nest Builder") + 
  facet_wrap(~nest_structure)

builder_vs_type + scale_fill_brewer(palette="BrBG")
```

Alternatively:
```{r}
dataset %>% 
  filter(nest_builder != "neither") %>% 
  ggplot(aes(x=nest_structure, fill=nest_builder)) +
  geom_bar(position = "dodge", color="black") +
  theme(axis.text.x = element_text(angle=50, hjust=1)) +
  labs(title="Nest Structure by Builder Sex",
       x="Site", 
       y="Count",
       fill="Nest Builder") +
  scale_fill_brewer(palette="BrBG")
```

3. How does the sex of the nest builder correlate with our continuous variables?

Nest builder and mean clutch size:
```{r}
dataset %>% 
  filter(nest_builder != "neither") %>%
  filter(clutch_size_mean != "NA") %>% 
  ggplot(aes(x=nest_builder, y=clutch_size_mean, 
             fill=nest_builder)) +
  geom_boxplot() +
  labs(title="Mean Clutch Size by Builder Sex",
       x=NULL, 
       y="Mean Clutch Size",
       fill="Nest Builder") +
  scale_fill_brewer(palette="BrBG")
```

4. incubating_sex... nest builder

5. length_breeding...  nest builder 

6. latitude_mean...  nest builder
_The code/plots for the other continuous variables would be similar._